<!--
Copyright 2023 The Chromium Authors
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<!--
This file is used to generate a comprehensive list of Compose histograms
along with a detailed description for each histogram.

For best practices on writing histogram descriptions, see
https://chromium.googlesource.com/chromium/src.git/+/HEAD/tools/metrics/histograms/README.md

Please follow the instructions in the OWNERS file in this directory to find a
reviewer. If no OWNERS file exists, please consider signing up at
go/reviewing-metrics (Googlers only), as all subdirectories are expected to
have an OWNERS file. As a last resort you can send the CL to
chromium-metrics-reviews@google.com.
-->

<histogram-configuration>

<histograms>

<histogram name="Compose.ContextMenu.CTR" enum="ComposeContextMenuCtrEvent"
    expires_after="2024-03-31">
  <owner>sophey@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Histogram for calculating the click-through rate (CTR) of the Compose
    context menu item. Logged each time the menu item is displayed and when
    Compose is opened from the context menu. CTR is calculated through
    `opened`/`displayed`.
  </summary>
</histogram>

<histogram name="Compose.ContextMenu.ShowStatus" enum="ComposeShowStatus"
    expires_after="2024-03-31">
  <owner>sophey@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Histogram that records the show status of the Compose context menu item.
    Logged each time the menu item is displayed or blocked from displaying (with
    a reason why).
  </summary>
</histogram>

<histogram name="Compose.Dialog.InnerTextShortenedBy" units="bytes"
    expires_after="2024-03-31">
  <owner>sophey@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    The amount trimmed from the inner text from the page (in bytes) when the
    dialog is opened. The text is trimmed to inner_text_max_bytes before being
    sent to Compose. Logged each time the dialog is opened if the text is
    trimmed.
  </summary>
</histogram>

<histogram name="Compose.Dialog.InnerTextSize" units="bytes"
    expires_after="2024-03-31">
  <owner>sophey@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    The size, in bytes, of the untrimmed inner text from the page when the
    dialog is opened. The text is trimmed to inner_text_max_bytes before being
    sent to Compose. Logged each time the dialog is opened.
  </summary>
</histogram>

<histogram name="Compose.Dialog.OpenLatency" units="ms"
    expires_after="2024-03-31">
  <owner>cuianthony@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Time in milliseconds between triggering the Compose dialog to open and it
    being shown and interactable. Logged each time the dialog is shown.
  </summary>
</histogram>

<histogram name="Compose.Dialog.SelectionLength" units="chars"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    The length, in unicode code points (roughly characters), of the selection
    when a new Compose session is started. Recorded once per session start.
  </summary>
</histogram>

<histogram name="Compose.Response.Duration.Error" units="ms"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Time in milliseconds for an invalid response from the Compose service.
    Logged each time a response with status not equal to OK is received.
  </summary>
</histogram>

<histogram name="Compose.Response.Duration.Ok" units="ms"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Time in milliseconds for a valid response from the Compose service. Logged
    each time a response with status OK is received.
  </summary>
</histogram>

<histogram name="Compose.Response.Status" enum="ComposeResponseStatus"
    expires_after="2024-03-31">
  <owner>cuianthony@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Histogram for recording the Compose server response status. Logged each time
    a response from the server is received.
  </summary>
</histogram>

<histogram name="Compose.Session.CloseReason"
    enum="ComposeSessionCloseReasonType" expires_after="2024-11-01">
  <owner>petewil@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    When a session ends, record how we exited the session, whether by accepting
    the input, canceling wiht the close button, or losing focus and not going
    back to the session.
  </summary>
</histogram>

<histogram name="Compose.Session.ComposeCount.{Status}" units="count"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Count of the number of Compose requests for {Status} sessions. Recorded once
    per session when it is closed or distroyed.
  </summary>
  <token key="Status">
    <variant name="Accepted"/>
    <variant name="Ignored"/>
  </token>
</histogram>

<histogram name="Compose.Session.DialogShownCount.{Status}" units="count"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Count of the number of times the Compose dialog is shown in an {Status}
    session. Recorded once per session when it is closed or distroyed.
  </summary>
  <token key="Status">
    <variant name="Accepted"/>
    <variant name="Ignored"/>
  </token>
</histogram>

<histogram name="Compose.Session.UndoCount.{Status}" units="count"
    expires_after="2024-03-31">
  <owner>perrier@chromium.org</owner>
  <owner>chrome-compose-frontend@google.com</owner>
  <summary>
    Count of the number of times undo is done during an {Status} session.
    Recorded once per session when it is closed or distroyed.
  </summary>
  <token key="Status">
    <variant name="Accepted"/>
    <variant name="Ignored"/>
  </token>
</histogram>

</histograms>

</histogram-configuration>
