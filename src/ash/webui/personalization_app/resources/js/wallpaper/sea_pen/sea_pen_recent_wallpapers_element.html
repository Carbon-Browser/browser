<style include="wallpaper common">
  :host {
    overflow: hidden;
  }

  iron-list {
    width: 100%;
  }

  .recent-image-container {
    height: calc(var(--personalization-app-grid-item-height) + var(--personalization-app-grid-item-spacing));
    /* Media queries in trusted and untrusted code will resize to 25% at
     * correct widths.  Subtract 0.34px to fix subpixel rounding issues with
     * iron-list. This makes sure all photo containers on a row add up to at
     * least 1px smaller than the parent width.*/
    width: calc(100% / 3 - 0.34px);
  }

  @media(min-width: 720px) {
    .recent-image-container {
      /* Subtract 0.25px to fix subpixel rounding issues with iron-list. This
       * ensures all grid items in a row add up to at least 1px smaller than the
       * parent width. */
      width: calc(100% / 4 - 0.25px);
    }
  }

  wallpaper-grid-item.recent-image {
    --wallpaper-grid-item-width: 100%;
    height: 100%;
  }

  .menu-icon-container {
    background-color: var(--cros-bg-color);
    border-top-left-radius: 50%;
    bottom: 0px;
    padding: 8px;
    position: absolute;
    right: 0px;
    z-index: 2;
  }

  .menu-icon-container:before {
    border-bottom-right-radius: 50%;
    bottom: 8px;
    box-shadow: 0 8px 0 0 var(--cros-bg-color);
    content: "";
    height: 16px;
    position: absolute;
    right: 36px;
    width: 16px;
  }

  .menu-icon-container:after {
    border-bottom-right-radius: 50%;
    bottom: 36px;
    box-shadow: 8px 0px 0 0 var(--cros-bg-color);
    content: "";
    height: 16px;
    position: absolute;
    right: 8px;
    width: 16px;
  }

  .menu-icon-button {
    --cr-icon-button-size: 20px;
    background-color: var(--cros-sys-app_base_shaded);
    margin-inline: 0;
  }

  .recent-image[aria-selected='true']::part(icon) {
    --cr-icon-button-size: 20px;
    background-color: var(--cros-bg-color);
    border-bottom-right-radius: 50%;
    left: -8px;
    padding: 8px;
    top: -8px;
  }

  .recent-image[aria-selected='true']::part(item) {
    border-radius: var(--personalization-app-grid-item-border-radius);
  }

  .recent-image[aria-selected='true']::part(icon):before {
    border-top-left-radius: 50%;
    top: 8px;
    box-shadow: 0 -8px 0 0 var(--cros-bg-color);
    content: "";
    height: 16px;
    left: 36px;
    position: absolute;
    width: 16px;
  }

  .recent-image[aria-selected='true']::part(icon):after {
    border-top-left-radius: 50%;
    box-shadow: -8px 0px 0 0 var(--cros-bg-color);
    content: "";
    height: 16px;
    left: 8px;
    position: absolute;
    top: 36px;
    width: 16px;
  }

</style>
<template is="dom-if" if="[[shouldShowRecentlyUsedWallpapers_(recentImages_)]]">
  <!-- TODO(b/308200616): Add finalized strings -->
  <h2 class="wallpaper-collections-heading">Recently used Sea Pen wallpaper</h2>
  <iron-list id="grid"
      items="[[recentImagesToDisplay_]]"
      as="image"
      grid
      aria-setsize$="[[recentImagesToDisplay_.length]]"
      role="listbox">
    <template>
      <div class="recent-image-container">
        <wallpaper-grid-item
            class="recent-image"
            index="[[index]]"
            data-recent-image
            aria-posinset$="[[getAriaIndex_(index)]]"
            on-wallpaper-grid-item-selected="onRecentImageSelected_"
            role="option"
            selected="[[isRecentImageSelected_(image, currentSelected_, pendingSelected_)]]"
            src="[[getRecentImageUrl_(image, recentImageData_, recentImageDataLoading_)]]"
            tabindex$="[[tabIndex]]">
        </wallpaper-grid-item>
        <div class="menu-icon-container">
          <cr-icon-button class="menu-icon-button" data-id$="[[index]]" iron-icon="cr:more-vert"
              role="button" on-click="onClickMenuIcon_">
          </cr-icon-button>
        </div>
        <cr-action-menu class="action-menu-container">
          <button data-id$="[[index]]" class="dropdown-item more-like-this-option"
              on-click="onClickMoreLikeThis_">
            More like this
          </button>
          <button data-id$="[[index]]" class="dropdown-item delete-wallpaper-option"
              on-click="onClickDeleteWallpaper_">
            Delete wallpaper
          </button>
          <button data-id$="[[index]]" class="dropdown-item wallpaper-info-option"
              on-click="onClickWallpaperInfo_">
            Wallpaper info
          </button>
        </cr-action-menu>
        <template is="dom-if" if="[[shouldShowWallpaperInfoDialog_(index, currentShowWallpaperInfoDialog_)]]" restamp>
          <cr-dialog id="wallpaperInfoDialog" data-id$="[[index]]" on-close="onCloseDialog_" show-on-attach>
            <div slot="body">
              <h2>Wallpaper Info</h2>
              <p>[[getWallpaperInfoMessage_(image, recentImageData_, recentImageDataLoading_)]]</p>
            </div>
            <div slot="button-container">
              <cr-button id="wallpaperInfoCloseButton" class="action-button primary" on-click="onCloseDialog_">
                Close
              </cr-button>
            </div>
          </cr-dialog>
        </template>
      </div>
    </template>
  </iron-list>
</template>
